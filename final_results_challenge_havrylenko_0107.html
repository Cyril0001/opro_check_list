<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>OPRO Challenge Results</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto+Condensed:wght@400;700&display=swap&subset=cyrillic" rel="stylesheet">
  <style>
    body {
      font-family: 'Roboto Condensed', sans-serif;
      background: #f6f6f6;
      padding: 10px;
      color: #333;
    }
    .container {
      max-width: 480px;
      margin: 0 auto;
      background: white;
      padding: 10px;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }
    .banner {
      background-color: #ff6005;
      text-align: center;
      padding: 0px 0;
    }
    .banner img {
      width: 400px;
      max-width: 100%;
    }
    .spacer {
      height: 0px;
      background-color: white;
    }
    .title-flex {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      justify-content: space-between;
      margin: 20px 0;
    }
    .title-cover {
      background-color: white;
      border: 1px solid #ff6005;
      width: 50%;
      text-align: left;
      padding: 0;
    }
    .label-box {
      background-color: #ff6005;
      border-bottom: 1px solid #ff6005;
      color: white;
      font-family: 'Noto Serif Display', serif;
      font-size: 20px;
      font-weight: 400;
      padding: 4px 30px;
      white-space: nowrap;
    }
    .title-box {
      background-color: white;
      color: #444;
      font-family: 'Noto Serif Display', serif;
      font-size: 25px;
      font-weight: 400;
      padding: 4px 30px;
      white-space: nowrap;
    }
    .results-label {
      color: #ff6005;
      font-size: 20px;
      font-weight: bold;
      padding: 10px;
      flex-grow: 1;
      text-align: center;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
      font-size: 12px;
    }
    th, td {
      padding: 6px;
      text-align: center;
      border: 1px solid #ccc;
    }
    th {
      background-color: #ff6005;
      color: white;
      cursor: pointer;
    }
    tr:nth-child(even) {
      background-color: #f2f2f2;
    }
    td:nth-child(4) { width: 80px; }
    td:nth-child(6) { width: 36px; }
  </style>
  <script>
    let sortDir = Array(6).fill(true);
    function sortTable(n) {
      const table = document.getElementById("resultsTable");
      const tbody = table.tBodies[0];
      const rows = Array.from(tbody.rows);
      const asc = sortDir[n];
      const actualIndex = n === 5 ? 3 : n;
      rows.sort((a, b) => {
        let x = a.cells[actualIndex].innerText;
        let y = b.cells[actualIndex].innerText;
        if (actualIndex === 3) {
          return asc ? new Date('2025-' + x) - new Date('2025-' + y) : new Date('2025-' + y) - new Date('2025-' + x);
        }
        if (!isNaN(x) && !isNaN(y)) {
          return asc ? x - y : y - x;
        }
        return asc ? x.localeCompare(y) : y.localeCompare(x);
      });
      rows.forEach(row => tbody.appendChild(row));
      sortDir[n] = !asc;
    }
  </script>
</head>
<body>
  <div class="container">
    <div class="banner">
      <img src="https://opro-check-list.vercel.app/images/OrienteeringPRO_AR_OK_logo-white.png" alt="OPRO Challenge banner">
    </div>
    <div class="spacer"></div>
    <div class="title-flex">
      <div class="title-cover">
        <div class="label-box">OPRO Challenge&nbsp;&nbsp;&nbsp;</div>
        <div class="title-box">Havrylenko #1&nbsp;&nbsp;&nbsp;</div>
      </div>
      <div class="results-label">РЕЗУЛЬТАТЫ</div>
    </div>
    <table id="resultsTable">
      <thead>
        <tr>
          <th onclick="sortTable(0)">Место</th>
          <th onclick="sortTable(1)">Баллы</th>
          <th onclick="sortTable(2)">Ник</th>
          <th onclick="sortTable(3)">Дата</th>
          <th onclick="sortTable(4)">Время</th>
          <th onclick="sortTable(5)">Шансы</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
    <script>
      const toSeconds = t => t.split(':').reduce((s, v, i) => s + (+v) * Math.pow(60, 2 - i), 0);
      const toDate = d => new Date(`2025-${d.split(' ')[0]}T${d.split(' ')[1]}`);
      const getRandomDateTime = (baseDay, index) => {
        const date = new Date(2025, 5, baseDay + Math.floor(index / 10), 9 + (index % 10), (index * 7) % 60);
        return `${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')} ${String(date.getHours()).padStart(2, '0')}:${String(date.getMinutes()).padStart(2, '0')}`;
      };
      const getBonusChances = (completionOrder) => {
        if (completionOrder <= 5) return 'x10';
        if (completionOrder <= 10) return 'x5';
        if (completionOrder <= 15) return 'x3';
        return '';
      };
      let runners = Array.from({ length: 50 }, (_, i) => {
        const completionOrder = (i * 13) % 50;
        const date = getRandomDateTime(1, completionOrder);
        const rawTime = `${String(1 + Math.floor(Math.random() * 3)).padStart(2, '0')}:${String(Math.floor(Math.random() * 60)).padStart(2, '0')}:${String(Math.floor(Math.random() * 60)).padStart(2, '0')}`;
        return {
          score: 10 + Math.floor(Math.random() * 40),
          name: `runner_${i + 1}`,
          date,
          time: rawTime,
          bonus: getBonusChances(completionOrder + 1)
        };
      });
      runners.sort((a, b) => {
        if (a.score !== b.score) return b.score - a.score;
        const dateA = toDate(a.date);
        const dateB = toDate(b.date);
        if (dateA.getTime() !== dateB.getTime()) return dateA - dateB;
        return toSeconds(a.time) - toSeconds(b.time);
      });
      const tbody = document.querySelector("#resultsTable tbody");
      runners.forEach((row, index) => {
        tbody.innerHTML += `<tr>
          <td>${index + 1}</td>
          <td>${row.score}</td>
          <td>${row.name}</td>
          <td>${row.date}</td>
          <td>${row.time}</td>
          <td>${row.bonus}</td>
        </tr>`;
      });
    </script>
  </div>
</body>
</html>
